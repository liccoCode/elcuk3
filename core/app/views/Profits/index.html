#{extends 'main_full.html'/}
#{set title:"SKU利润分析" /}
#{set 'moreScripts'}
    #{script 'profits/index.coffee'/}
#{/set}

#{info_row}
<ul>
  <li><strong>[SKU利润查询]</strong>SKU利润查询</li>
</ul>
#{/info_row}
#{flash_alert /}
#{errorMsgs /}

#{form @Profits.index(), class:'search_form', id:'profits_form'}
<div class="row-fluid">
  <div class="span12">
    <div class="input-prepend input-append inline">
      <span class="add-on">From:</span>
      <input type="date" name="p.begin" value="${p.begin.date()}">
      <span class="add-on">To:</span>
      <input type="date" name="p.end" value="${p.end.date()}">
    </div>

    <div class="inline">
        #{select_enum name:'p.market', items:models.market.M.values(), value:p.market}
          <option value="market">Market</option>
          <option value="total">汇总</option>
        #{/select_enum}

      <th>Category:</th>
      <td>
        <input type="text" name="p.category" data-provide="typeahead" data-source="${categorys}"
               value="${p?.category}" id="unit_category">
      </td>

      <th>SKU:</th>
      <td>
        <input type="text" name="p.sku" data-provide="typeahead" data-source="${skus}"
               value="${p?.sku}" id="unit_sku">
      </td>

    </div>

    <div class="input-prepend input-append inline">
      <span class="add-on"><i class="icon-search"></i></span>
      <button class="btn btn-primary" data-loading>搜索</button>
    </div>
  </div>
</div>

<div class="row-fluid">
  <div class="span12">
    <table class="table table-condensed table-bordered">
      <tr>
        <th>SKU</th>
        <th>市场</th>
        <th>SKU总利润(USD)</th>
        <th>SKU利润率(%)</th>
        <th>SKU销售额(USD)</th>
        <th>亚马逊费用(USD)</th>
        <th>FBA费用(USD)</th>
        <th>SKU销量</th>
        <th>平均采购价(USD)</th>
        <th>平均运费单价(USD)</th>
        <th>关税和VAT单价(USD)</th>
      </tr>
        #{list items:Profits, as:'pro'}
          <tr>
            <td>${pro.sku}</td>
            <td>${pro.market?pro.market.label():"汇总"}</td>
            <td>${pro.totalprofit}</td>
            <td>${pro.profitrate}</td>
            <td>${pro.totalfee}</td>
            <td>${pro.amazonfee}</td>
            <td>${pro.fbafee}</td>
            <td>${pro.quantity}</td>
            <td>${pro.procureprice}</td>
            <td>${pro.shipprice}</td>
            <td>${pro.vatprice}</td>
          </tr>
        #{/list}
    </table>
  </div>
</div>
#{/form}