*{需要
* ProcueUnit: unit
* Whouse: whouses
}*
#{set product: unit.selling?.listing?.product/}

<tr>
  <th>SellingId</th>
  <td>
  #{text_input id:'sellingId', name: 'unit.selling.sellingId', value: unit.selling?.sellingId,
    readonly: unit.selling?.sellingId?true:''/}
  </td>
  <th>SKU</th>
  <td>
  #{text_input id:'unit_sku', name: 'unit.product.sku', value: product?.sku,
      readonly: product?.sku?true:'', datasource: skus/}
  </td>
</tr>

<tr>
#{set copers:product?.cooperators() /}
  <th>供应商</th>
  <td>
  #{select 'unit.cooperator.id', items: copers, labelProperty: 'name', value: unit.cooperator?.id}
      #{option ''}请选择#{/option}
  #{/select}
  </td>

  <th>价格</th>
  <td>
    <div class="input-append">
      <input type="text" class="span1" id="unit_price" name="unit.attrs.price" value="${unit.attrs.price}">
    #{pickCurrency id:'unit_currency', name:'unit.attrs.currency', class:'span2', c:unit.attrs.currency?:helper.Currency.CNY /}
    </div>
  </td>
</tr>

<tr>
  <th>采购数量</th>
  <td>
    <div class="input-append">
      <input type="text" class="input-mini" placeHolder="具体数量" name="unit.attrs.planQty" value="${unit.attrs.planQty}">
      <input type="text" id="box_num" class="input-mini" placeHolder="箱数">
      <span class="add-on">箱</span>
    </div>
    <input type="hidden" name="unit.attrs.qty" value="${unit.attrs.qty}">
  </td>
  <th>预计交货日期</th>
  <td>
    <input type="date" name="unit.attrs.planDeliveryDate" value="${unit.attrs.planDeliveryDate.date()}">
    <input type="hidden" name="unit.attrs.deliveryDate" value="${unit.attrs.deliveryDate.date()}">
  </td>
</tr>

<tr>
  <th>预计运输时间</th>
  <td>
    <input type="date" name="unit.attrs.planShipDate" value="${unit.attrs.planShipDate.date()}">
  </td>
  <th>预计到库时间</th>
  <td>
    <div class="input-append">
      <input type="date" name="unit.attrs.planArrivDate" value="${unit.attrs.planArrivDate.date()}">
      <span class="add-on">? 天</span>
    </div>
  </td>
</tr>

<tr>
  <th>去往仓库</th>
  <td>
  #{select 'unit.whouse.id', items: whouses, labelProperty: 'name', value: unit.whouse?.id}#{/select}
  </td>
  <th>阶段</th>
  <td>
    <span style="color:${unit.stage.rgb()}">${unit.stage.label()}</span>
  </td>
</tr>

<tr>
  <th>运输方式</th>
  <td>
  #{list items:models.procure.Shipment.T.values(), as:'t'}
    <label class="radio">
      <input type="radio" name="unit.shipType" value="${t.name()}" ${ t == unit.shipType ? 'checked': 'unchecked'}>
    ${t.label()}
    </label>
  #{/list}
  </td>
  <td colspan="2">
  #{list items: unit.relateShipment()}
    <div>
      <a href="@{Shipments.show(_.id)}" target="_blank">${_.id} (${_.type.label()})</a>
      <span><i class="icon-calendar"></i> #{time_tooltip time: _.dates.planBeginDate/}</span>
      <span><i class="icon-calendar"></i> #{time_tooltip time: _.predictArriveDate()/}</span>
    </div>
  #{/list}
  </td>
</tr>

<tr>
  <td colspan="4">
    <h4>Memo</h4>
    <textarea rows="8" class="span12" name="unit.comment">${unit.comment.raw()}</textarea>
  </td>
</tr>
