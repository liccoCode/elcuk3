<tr>
  <th style="width:100px;">SellingId</th>
  <td style="width:650px;">
    <input type="text" name="unit.selling.sellingId" id="sellingId" style="width:300px;" value="${unit.selling?.sellingId}"
    #{if unit.selling?.sellingId} readonly #{/if}>
  </td>
  <th style="width:100px;">SKU</th>
  <td>
    <input type="text" name="unit.product.sku" id="unit_sku" value="${unit.selling?.listing?.product?.sku}"
    #{if unit.selling?.listing?.product?.sku} readonly #{/if}required>
  </td>
</tr>
<tr>
  <th>产品名称</th>
  <td>
    <input type="text" id="productName" style="width:300px;" value="${unit.selling?.listing?.product?.abbreviation}"
    #{if unit.selling?.listing?.product?.abbreviation} readonly #{/if}required>
  </td>
  <th>阶段</th>
  <td>
    <span style="color:${unit.stage.rgb()}">${unit.stage.label()}</span>
  </td>
</tr>

<tr>
  <th>预计交货日期</th>
  <td>
    <input type="date" name="unit.attrs.planDeliveryDate" value="${unit.attrs.planDeliveryDate.date()}" required>
  #{if oldplanDeliveryDate!=null}
    <span class="add-on">比原预计交货日期${oldplanDeliveryDate.date()}推迟${(unit.attrs
    .planDeliveryDate.getTime()-oldplanDeliveryDate.getTime())/(24*60*60*1000)}天</span>
  #{/if}
    <input type="hidden" name="unit.attrs.deliveryDate" value="${unit.attrs.deliveryDate.date()}">
  </td>
  <th>去往仓库</th>
  <td>
    <select name="unit.whouse.id" id="warehouse_select">
      <option value="">请选择</option>
    #{list items:whouses, as:'w'}
      <option value="${w.id}">${w.name}</option>
    #{/list}
    </select>
  </td>
</tr>

<tr>
  <th>采购数量</th>
  <td colspan="3">
    <input type="text" class="input-mini" placeHolder="具体数量" name="unit.attrs.planQty" id="planQty"
           value="${unit.attrs.planQty}">
    <input type="text" id="box_num" class="input-mini" placeHolder="箱数">
    <span class="add-on">箱</span>
    <input type="hidden" name="unit.attrs.qty" value="${unit.attrs.qty}">
    &nbsp;&nbsp;&nbsp;
    <select id="cooperator" name="unit.cooperator.id" coop_value="${unit.cooperator?.id}">
      <option value="">供应商参考</option>
    </select>
    <span id="coop_text"></span>
  </td>
</tr>

<tr>
  <th>预计运输时间</th>
  <td>
    <input type="date" name="unit.attrs.planShipDate" value="${unit.attrs.planShipDate.date()}">
  </td>
  <th>预计到库时间</th>
  <td>
    <input type="date" name="unit.attrs.planArrivDate" value="${unit.attrs.planArrivDate.date()}">
    <span class="add-on">? 天</span>
  </td>
</tr>

<tr>
  <th>运输方式</th>
  <td>
  #{list items:models.procure.Shipment.T.values(), as:'t'}
    <label class="radio">
      <input type="radio" name="unit.shipType" value="${t.name()}" ${ t == unit.shipType ? 'checked': 'unchecked'}>${t.detail()}
    </label>
  #{/list}
  </td>
  <td colspan="2">
  #{list items: unit.relateShipment()}
    <div>
      <a href="@{Shipments.show(_.id)}" target="_blank">${_.id} (${_.type.label()})</a>
      <span><i class="icon-calendar"></i> #{time_tooltip time: _.dates.planBeginDate/}</span>
      <span><i class="icon-calendar"></i> #{time_tooltip time: _.predictArriveDate()/}</span>
    </div>
  #{/list}
  </td>
</tr>

<tr>
  <td colspan="4">
    <h4>Memo</h4>
    <textarea rows="8" class="span12" name="unit.comment" id="memo">${unit.comment.raw()}</textarea>
  </td>
</tr>
