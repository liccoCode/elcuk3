#{extends 'main_full.html'/}
#{set title:'Orders (' + orders.size() + ')'/}
#{set 'moreScripts'}
    #{script 'orders/orders.coffee'/}
    #{script 'component/pagination.coffee'/}
#{/set}

<div class="row">
    <form id="search_form" action="@{Orders.index()}" method="post">
        <div class="span8">
            <div class="row">
                <div class="input-prepend span2">
                    <span class="add-on">From:</span>
                    <input type="date" style="width:100px;" id="p_from" name="p.from" value="${p.from?.date()}">
                </div>

                <div class="input-prepend span2">
                    <span class="add-on">To:</span>
                    <input type="date" style="width:100px;" id="p_to" name="p.to" value="${p.to?.date()}">
                </div>

                <div class="span3 input-prepend">
                    <span class="add-on">Search:</span>
                    <input type="text" style="width:120px;" name="p.search" placeholder="关键字搜索; +2 销售数量大于 2;" value="${p.search}">
                </div>
            </div>
            <div class="row">
                <div class="span5">
                    <select id="o_market" name="p.market" style="width:100px;">
                        <option value="">Market(ALL)</option>
                    #{list items:models.market.M.values()}
                        <option ${_ == p.market ? 'selected' : ''} value="${_.name()}">${_}</option>
                    #{/list}
                    </select>
                    <select id="o_acc" name="p.accountId" style="width:100px;">
                        <option value="">Account</option>
                    #{list items:accs}
                        <option ${_.id == p.accountId ? 'selected' : ''} value="${_.id}">${_.prettyName()}</option>
                    #{/list}
                    </select>
                    <select id="o_state" name="p.state" style="width:100px;">
                        <option value="">State(ALL)</option>
                    #{list items:models.market.Orderr.S.values()}
                        <option ${_ == p.state ? 'selected' : ''} value="${_.name()}">${_}</option>
                    #{/list}
                    </select>

                    <input type="hidden" name="p.orderBy" id="orderBy" value="createDate">
                    <select name="p.desc" class="span4" style="width:100px;">
                        <option value="DESC">DESC</option>
                        <option value="ASC">ASC</option>
                    </select>
                </div>

            </div>
        </div>
        <div class="span4" id="search_btns">
            <input type="hidden" name="p.page" value="${p.page}">
            <button class="btn btn-primary" data-loading>Search</button>
        </div>
    </form>
</div>
<hr>

<div class="row-fluid" id="order_list">
    <div class="span12">
    #{if orders.size() == 0}
        暂时还没有订单
    #{/if}
    #{else }
        <table class="table table-condensed table-bordered">
            #{render 'Orders/_order_table_tr.html', items:orders/}
            <tr class="tb_footer">
                <td colspan="10">
                    #{bootstrap_pager pi:p, url:'' /}
                </td>
            </tr>
        </table>
    #{/else}
    </div>
</div>
