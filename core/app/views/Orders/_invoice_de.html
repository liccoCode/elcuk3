<!DOCTYPE html>
<html xmlns:yahp="http://www.allcolor.org/xmlns/yahp">
<head>
  <title>Shipment Invoice</title>
  <style type="text/css">
    table{
      border:0px solid;
      text-align:center;
    }

    td{
      border:0px solid #000000;
    }

    .tr1{
      font:18px bold;
      background-color:#9c9c9c;

    }

    .tr2{
      height:50px;
    }

    .td1{
      width:50%;
      text-align:left;
      padding:10px;
      font:14px bold;
    }

    .td2{
      width:50%;
      text-align:right;
      padding:10px;
      font:14px bold;
    }

    .td3{
      border:1px solid #000000;
    }

    .td4{
      width:60%;
      text-align:left;
      padding:10px;
      font:14px bold;
    }

    .table1{
      border:1px solid;
      text-align:center;
    }

    .div1{
      border-bottom:0px;
      padding-left:0px;
      width:99.7%;
      height:100px;
    }

    .div2{
      text-align:right;
      padding-top:20px;
      width:99.7%;
    }


  </style>
</head>
<body>


<form action="@{Orders.invoicede()}" method="post" id="create_invoice_form" target="_blank">
  <table cellpadding="4px" style="width:70%" cellspacing="0" align='center'>
    <input type="hidden" name="invoice.orderid" value="${ord.orderId}">
    <tr>
      <td class="td1">
        <strong><font style="font-weight: bold;" size="4pt">Rechnung #: ${ord.orderId}</font> </strong><br>
        Datum: ${new org.joda.time.DateTime(ord.createDate).toString("dd/MM/yyyy")}
      </td>
      <td rowspan="4" class="td2">
        <div class="div1">
          <img src="/images/common/easyacc.png" style="height:100%">
        </div>
      </td>
    </tr>
    <tr>
      <td class="td1"></td>
    </tr>
    <tr>
      <td></td>
    </tr>
    <tr>
      <td></td>
    </tr>

    <tr>
      <td class="td4">
        <strong>To</strong> <br>
      ${ord.buyer}<br>
      #{if invoice != null}
        <input style="width:100%" type="text" id="invoiceto" name="invoice.invoiceto" value="${invoice.invoiceto.replace("DE","Deutschland")}">
      #{/if}
      #{else}
          #{if ord.address1!=null && ord.address1.length()>0}
            <input style="width:100%" type="text" id="invoiceto" name="invoice.invoiceto" value="${ord.address1
            .replace("DE","Deutschland")}">
          #{/if}
          #{else}
            <input style="width:100%" type="text" id="invoiceto" name="invoice.invoiceto" value="${ord.address.replace("DE","Deutschland")}">
          #{/else}
      #{/else}

      </td>
      <td class="td2">
        <strong>From</strong> <br>
        TUGGLE ELECTRONIC COMMERCE CO.,LTD <br>
        Unit A5, 9/F Silvercorp Int'l <br>
        Tower 707-713 Nathan Rd <br>
        Mongkok, KL <br>
        999077 Hongkong <br>
        <strong>Steuernummer: 1667318915</strong> <br>
      </td>
    </tr>


    <tr>
      <td class="td4"><strong>Lieferadresse</strong><br>

      #{if invoice != null}
        <input style="width:100%" type="text" id="address" name="invoice.address" value="${invoice.address.replace("DE","Deutschland")}">
      #{/if}
      #{else}
          #{if ord.address1!=null && ord.address1.length()>0}
            <input style="width:100%" type="text" id="address" name="invoice.address" value="${ord.address1.replace("DE","Deutschland")}">
          #{/if}
          #{else}
            <input style="width:100%" type="text" id="address" name="invoice.address" value="${ord.address.replace("DE","Deutschland")}">
          #{/else}
      #{/else}

      </td>
      <td rowspan="2"></td>
    </tr>

  </table>


  <table class="table1" cellpadding="8px" style="width:70%" cellspacing="0" align='center'>
    <tr>
      <td class="td3"><strong>Beschreibung</strong></td>
      <td class="td3"><strong>Menge</strong></td>
      <td class="td3"><strong>Stückpreis(€)</strong></td>
      <td class="td3"><strong>Betrag(€)</strong></td>
    </tr>


  #{list items:ord.items, as:'item'}
    <tr>
      <td class="td3" style="width:50%">${item.product.productName}</td>
      <td class="td3">${item.quantity}</td>

        #{if invoice != null}
          <td class="td3"><input type="text" name="invoice.price" value="${invoice.price.get(item_index-1)}"></td>
          <td class="td3">${new BigDecimal(item.quantity).multiply(new BigDecimal(invoice.price.get(item_index-1)))
          .setScale(2, 4).floatValue()}</td>
        #{/if}
        #{else }
          <td class="td3"><input type="text" name="invoice.price" value="${new BigDecimal(item.price).divide(new
          BigDecimal(models.market.OrderInvoice.devat),2,
          java.math.RoundingMode.HALF_DOWN)}"></td>
          <td class="td3">${new BigDecimal(item.quantity).multiply(new BigDecimal(item.price).divide(new
          BigDecimal(models.market.OrderInvoice.devat),2,
          java.math.RoundingMode.HALF_DOWN)).setScale(2, 4).floatValue()}</td>
        #{/else}
    </tr>
  #{/list}





    <tr>
      <td class="td3"></td>
      <td class="td3"></td>
      <td class="td3"><strong>Zwischensumme</strong></td>

    #{if invoice != null}
      <td class="td3"><input type="text" name="invoice.notaxamount" value="${invoice.notaxamount}"></td>
    #{/if}
    #{else }
      <td class="td3"><input type="text" name="invoice.notaxamount" value="${notaxamount}"></td>
    #{/else}


    </tr>
    <tr>
      <td class="td3"></td>
      <td class="td3"></td>
      <td class="td3"><strong>MwST(19%)</strong></td>
      <td class="td3">${tax}</td>
    </tr>

    <tr>
      <td class="td3"></td>
      <td class="td3"></td>
      <td class="td3"><strong>Summe</strong></td>
      <td class="td3"><strong>${totalamount}</strong></td>
    </tr>

    <tr>
      <td class="td1" colspan="4">
        <button class="btn btn-primary">保存并下载订单发票</button>
      #{if invoice!=null}
        <br>已开发票 开票人:${invoice.updator} 开票时间:${new org.joda.time.DateTime(invoice.updateDate).toString("dd/MM/yyyy")}
      #{/if}
      #{else}
        <br>未开发票
      #{/else}
      </td>
    </tr>

  </table>
</form>

#{records records:records/}

</body>
</html>