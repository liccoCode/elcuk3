#{extends 'main_full.html'/}
#{set title:'FeeTypes'/}
#{set 'moreScripts'}
    #{script 'feeTypes/feeTypes.es6'/}
#{/set}

#{warning_row ''}
<ol>
  <li>请只使用两级</li>
</ol>
#{/warning_row}

<div class="btn-toolbar">
  <button class="btn btn-success" id="show_modal">新添加 FeeType</button>
</div>

<div class="row-fluid">
  <table class="table table-bordered table-condensed types">
    <tr>
      <th>Parent_Name</th>
      <th>Child_Name</th>
      <th>NickName</th>
      <th>解释</th>
      <th>快捷查询</th>
      <th>创建时间</th>
      <th>更新时间</th>
      <th>Action</th>
    </tr>
  #{list items:types, as:'top'}
  <tr>
      #{if top.children.size()==0}
        <td>${top.name}</td>
        <td></td>
        <td>${top.nickName}</td>
        <td>${top.memo}</td>
        <td>${top.shortcut}</td>
        <td>${top.createdAt.los()}</td>
        <td>${top.updateAt.los()}</td>
        <td>
          <button class="btn btn-mini btn-primary" name="update_btn" data-name="${top.name}" data-demo="${top.memo}"
                  data-nick="${top.nickName}" data-short="${top.shortcut}">更新
          </button>
          <button class="btn btn-mini btn-danger delete">删除</button>
        </td>
      </tr>
      #{/if}
      #{else }
        <td rowspan="${top.children.size()+1}">${top.name}</td>
        <td></td>
        <td>${top.nickName}</td>
        <td>${top.memo}</td>
        <td>${top.shortcut}</td>
        <td>${top.createdAt.los()}</td>
        <td>${top.updateAt.los()}</td>
        <td>
          <button class="btn btn-mini btn-primary" name="update_btn" data-name="${top.name}" data-demo="${top.memo}"
                  data-nick="${top.nickName}" data-short="${top.shortcut}">更新
          </button>
          <button class="btn btn-mini btn-danger delete">删除</button>
        </td>
        </tr>
          #{list items:top.children, as:'c'}
            <tr>
              <td>${c.name}</td>
              <td>${c.nickName}</td>
              <td>${c.memo}</td>
              <td>${c.shortcut}</td>
              <td>${c.createdAt.los()}</td>
              <td>${c.updateAt.los()}</td>
              <td>
                <button class="btn btn-mini btn-primary" name="update_btn" data-name="${c.name}" data-demo="${c.memo}"
                        data-nick="${c.nickName}" data-short="${c.shortcut}">更新
                </button>
                <button class="btn btn-mini btn-danger delete">删除</button>
              </td>
            </tr>
          #{/list}
      #{/else}
  #{/list}
  </table>
</div>


<div id="create_modal" class="modal hide fade">
  <div class="modal-header">
    <h4>添加FeeType信息</h4>
  </div>
  <div class="modal-body" style="height:300px;">
    <form action="@{FeeTypes.create()}" method="post" id="create_form">
      <table class="table table-condensed table-bordered">
        <tr>
          <th>费用名称:</th>
          <td><input type="text" name="ft.name" required></td>
        </tr>
        <tr>
          <th>NickName:</th>
          <td><input type="text" name="ft.nickName" required></td>
        </tr>
        <tr>
          <th>费用解释:</th>
          <td><input type="text" name="ft.memo" required></td>
        </tr>
        <tr>
          <th>快捷查询:</th>
          <td><input type="text" name="ft.shortcut" required></td>
        </tr>
        <tr>
          <th>父费用类型:</th>
          <td>
            <select name="parentName">
              <option value="">TOP</option>
            #{list items:types, as:'parent'}
              <option value="${parent.name}">${parent.name}:${parent.memo}</option>
            #{/list}
            </select>
          </td>
        </tr>
      </table>
    </form>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
    <button class="btn btn-primary" id="submitCreateBtn">创建</button>
  </div>
</div>

<div id="update_modal" class="modal hide fade">
  <div class="modal-header">
    <h4>修改FeeType信息</h4>
  </div>
  <div class="modal-body" style="height:200px;">
    <form action="@{FeeTypes.update()}" method="post" id="update_form">
      <table class="table table-condensed table-bordered">
        <tr>
          <th>费用名称:</th>
          <td><input type="text" name="ft.name" readonly></td>
        </tr>
        <tr>
          <th>NickName:</th>
          <td><input type="text" name="ft.nickName" required></td>
        </tr>
        <tr>
          <th>费用解释:</th>
          <td><input type="text" name="ft.memo" required></td>
        </tr>
        <tr>
          <th>快捷查询:</th>
          <td><input type="text" name="ft.shortcut" required></td>
        </tr>
      </table>
    </form>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
    <button class="btn btn-primary" id="submitUpdateBtn">保存</button>
  </div>
</div>

