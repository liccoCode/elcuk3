#{extends 'main.html'/}
#{script 'component/amazon.coffee'/}

#{flash_alert /}
#{errorMsgs /}
<div class="alert alert-block alert-success fade in">
  <h4 class="alert-heading">Amazon 上架功能简介</h4>

  <p>&nbsp;</p>
  <ul>
    <li>Preview 功能拥有提示 Amazon 不允许的标签的功能, 能够方便的在这里检查出不允许的标签并查看到预览效果.</li>
    <li>Price 价格会根据这个 Selling 所在的市场来进行判断单位, 所以只需要填写对应市场的价格数值即可, 不用去转换.</li>
    <li>MerchantSKU 是根据 SKU 与 UPC 来确定的, 不允许手动修改. 所以对于 FBA 不发, 需要创建一个自卖产品的, 建议不在系统中处理.</li>
    <li>UPC 会检查并且给出已经上架的 Selling (需要处理历史数据...).</li>
    <li>RBN 可以的参考信息还需要进行补全.</li>
    <li>通过 Product 上架, 会自动创建 Listing(如果 Listing 存在, 则不会改变), Selling.</li>
  </ul>
</div>
<div id='check_modal' class="modal hide fade">
  <div class="modal-header">
    <h3>使用 <span id="upc_num"></span> 上架的 Selling</h3>
  </div>
  <div class="modal-body">
    <p class="text-error">当前 SKU 为: ${pro.sku}</p>

    <div class="innder-modal"></div>
  </div>
  <div class="modal-footer">
    <a href="#" id='check_cancel' data-dismiss='modal' class="btn">取消</a>
    <a href="#" id="check_apply" class="btn btn-primary">应用</a>
  </div>
  <blockquote class="template">
    <p class='check_title'></p>
    <small class='check_id'></small>
  </blockquote>
</div>

<form id='saleAmazonForm' action="@{Products.saleAmazonListing()}" method="post" autocomplete="off">
<table class="table table-condensed">
<tr>
  <td colspan="4">
    <a href="@{Products.show()}/${pro.sku}" class="btn btn-success">回退</a>
    <button class="btn btn-danger" data-confirm='确认上架?' data-disable-with='上架中...'>
      上架销售
    </button>
    <input type="hidden" name="s.state" value="${s.state.name()}">
  </td>
</tr>

<tr>
  <th>Title:</th>
  <td colspan="3">
    <textarea rows="2" name="s.aps.title" class="span12">${pro.productName}</textarea>
  </td>
</tr>

<tr>
  <th>MSKU:</th>
  <td>
    <input type="text" id="msku" name="s.merchantSKU" readonly="" value="${pro.sku}">
    <input type="hidden" id="sku" name="pro.sku" value="${pro.sku}">
  </td>
  <th>Acc:</th>
  <td>
    <select name="s.account.id" id="account">
      <option value="0">账号</option>
    #{list items:accs, as:'acc'}
      <option ${acc == s.account ? 'selected' : ''} value="${acc.id}">${acc.prettyName()}</option>
    #{/list}
    </select>
  </td>
</tr>

<tr>
  <th>UPC:</th>
  <td>
    <div class="input-append">
      <input type="text" class="span2" name="s.aps.upc" value="${s.aps.upc}">
      <button id='check_upc' class="btn btn-warning">@</button>
    </div>
  </td>
  <th>Condition/Market:</th>
  <td>
    <div class="input-append input-prepend">
      <input type="text" readonly="" name="s.aps.condition_" value="NEW" class="span1">
    #{pickMarkets id:'market', class:'span2', name:'s.market', m:s.market, blank:true/}
    </div>
  </td>
</tr>

<tr>
  <th>Manufac:</th>
  <td><input type="text" name="s.aps.manufacturer" value="EasyAcc"></td>
  <th>PartNumber:</th>
  <td>
    <input type="text" name="s.aps.manufacturerPartNumber" value="${s.aps.manufacturerPartNumber}">
  </td>
</tr>

<tr>
  <th>RBN:</th>
  <td>
    <div class="input-prepend">
    #{rbn_info /}
      <input type="text" style="width:80px;" name="s.aps.rbns" value="${s.aps.rbns[0]}">
      <input type="text" style="width:80px;" name="s.aps.rbns" value="${s.aps.rbns[1]}">
    </div>
  </td>
  <th>Qty:</th>
  <td><input type="text" name="s.aps.quantity" value="0"></td>
</tr>

<tr>
  <th>Price:</th>
  <td>
    <div class="input-prepend">
      <span class="currency add-on">&pound;</span>
      <input type="text" class="span2" name="s.aps.standerPrice" placeHolder="Ex:19.99" value="${s.aps.standerPrice}">
    </div>
  </td>
  <th>SalePrice:</th>
  <td>
    <div class="input-prepend">
      <div class="input-prepend">
        <span class="currency add-on">&pound;</span>
        <input type="text" class="span2" name="s.aps.salePrice" placeHolder="Ex:15.99" value="${s.aps.salePrice}">
      </div>
    </div>
  </td>
</tr>

<tr>
  <th>StartDate</th>
  <td>
    <input type="text" name="s.aps.startDate" value="${new java.util.Date().format("yyyy-MM-dd")}">
  </td>
  <th>EndDate</th>
  <td><input type="text" name="s.aps.endDate" value="2015-01-01"></td>
</tr>

<tr>
  <th>Gift Options</th>
  <td colspan="3">
    <label class="checkbox inline">
      <input name="s.aps.isGiftWrap" type="checkbox" ${s.aps.isGiftWrap ? 'checked':''} value="true">
      Gift&nbsp;Wrap
    </label>
    <label class="checkbox inline">
      <input name="s.aps.isGiftMessage" type="checkbox" ${s.aps.isGiftMessage ? 'checked':''} value="true">
      Gift&nbsp;Message
    </label>
  </td>
</tr>

<tr>
  <td colspan="4">
    <div class="input-prepend offset1" id="sellingPreview">
      <button id="sid_preview" class="btn">
        <i class="icon-search"></i>
      </button>
      <input type="text" data-provide="typeahead" data-items="4" data-source="${sids}" placeHolder="同 Product SID">
      <button class="btn">填充</button>
    </div>
  </td>
</tr>

<tr>
  <th rowspan="5">Technical:</th>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 bulletPoint" data-length='50' name="s.aps.keyFeturess"
             value="${s.aps.keyFeturess[0]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 bulletPoint" data-length='50' name="s.aps.keyFeturess"
             value="${s.aps.keyFeturess[1]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 bulletPoint" data-length='50' name="s.aps.keyFeturess"
             value="${s.aps.keyFeturess[2]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 bulletPoint" data-length='50' name="s.aps.keyFeturess"
             value="${s.aps.keyFeturess[3]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 bulletPoint" data-length='50' name="s.aps.keyFeturess"
             value="${s.aps.keyFeturess[4]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <th rowspan="5">SearchTerms:</th>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 searchTermss" data-length='2000' name="s.aps.searchTermss"
             value="${s.aps.searchTermss[0]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 searchTermss" data-length='2000' name="s.aps.searchTermss"
             value="${s.aps.searchTermss[1]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 searchTermss" data-length='2000' name="s.aps.searchTermss"
             value="${s.aps.searchTermss[2]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 searchTermss" data-length='2000' name="s.aps.searchTermss"
             value="${s.aps.searchTermss[3]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <td colspan="3">
    <div class="input-append">
      <input type="text" class="span11 searchTermss" data-length='2000' name="s.aps.searchTermss"
             value="${s.aps.searchTermss[4]}">
      <span class="add-on"></span>
    </div>
  </td>
</tr>

<tr>
  <th>ProductDesc:</th>
  <td colspan="3">
    <div class="input-append">
      <textarea rows="10" name="s.aps.productDesc" data-length='2000'
                class="span12 proDesc">${s.aps.productDesc?.trim()}</textarea>
      <div class="clearfix"></div>
      <span class="add-on">2000 bytes left</span>
      <button class="btn">Preview</button>
    </div>
    <div style='margin-top:-1px;border-top:1px dashed;'></div>
  </td>
</tr>
</table>
</form>

<script type="text/template" id="tsp-show-template">
  <h3>Product Desc</h3>

  <p><%= tsp['p'][0] %></p>

  <h3>Technical</h3>

  <p><%= tsp['t'].join('<br>') %></p>

  <h3>Search Terms</h3>

  <p><%= tsp['s'].join('<br>') %></p>

  <p>点击关闭, 点击 "放大镜" 重复查看</p>
</script>
