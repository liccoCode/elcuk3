#{extends 'main_full.html' /}
#{set title:'物流区域货量分析报表'/}
#{set 'moreScripts'}
    #{script_cdn name: 'ShipmentReports/areaGoodsAnalyze.coffee'/}
#{/set}

#{flash_alert /}
#{info_row title:'物流区域货量分析报表' /}

<form action="@{ShipmentReports.areaGoodsAnalyze()}" method="get" class="search_form" id='search_form'>
  <div class="row-fluid">
    <div class="span12">
      <select name="a.countryCode" class="inline" style="width:110px;" id="select_country">
        <option value="">市场</option>
        #{list items:a.queryCountryCode(), as:'code'}
          <option value="${code}" ${code==a.countryCode? 'selected' : ''}>${code}</option>
        #{/list}
      </select>

      <select name="a.centerId" class="inline" style="width:110px;" id="select_centerId">
        <option value="" selected="selected">centerID</option>
        #{list items: a.queryCenterIdByCountryCode(a.countryCode), as: 'center'}
          <option value="${center}" ${center==a.centerId? 'selected' : ''}>${center}</option>
        #{/list}
      </select>

      <div class="input-prepend inline">
        <span class="add-on">运输时间From:</span>
        <input type="date" name="a.from" value="${a.from.date()}">
      </div>

      <div class="input-prepend inline">
        <span class="add-on">To:</span>
        <input type="date" name="a.to" value="${a.to.date()}">
      </div>

      <div class="input-append input-prepend inline">
        <button class="btn btn-primary" id="searchdata" data-uri="@{ShipmentReports.areaGoodsAnalyze()}" data-loading>统计</button>
        <button class="btn btn-primary" id="exceldown" data-uri="@{Excels.areaGoodsAnalyzeExcel()}">导出Excel</button>
      </div>
    </div>
  </div>
</form>


<div class="row-fluid">
  <div class="span12">
    <b2>总运输单${a.caluFeeNum}个，计算了费用的${a.caluFeeNum-a.nocaluFeeNum}个，未计算费用的${a.nocaluFeeNum}个</b2>
    <table id="losstotal" class="table table-condensed table-bordered">
      <thead>
      <tr>
        <th rowspan="2" style="text-align:inherit">市场</th>
        <th style="text-align:center">仓库</th>
        <th colspan="8" style="text-align:center">数量</th>
        <th colspan="4" style="text-align:center">费用</th>
      </tr>
      <tr>
        <th>center ID</th>
        <th>总重量(kg)</th>
        <th>总体积(m³)</th>
        <th>海运重量(kg)</th>
        <th>海运体积(m³)</th>
        <th>空运重量(kg)</th>
        <th>空运体积(m³)</th>
        <th>快递重量(kg)</th>
        <th>快递体积(m³)</th>
        <th>总费用$</th>
        <th>空运$</th>
        <th>海运$</th>
        <th>快递$</th>
      </tr>
      </thead>
      <tbody>
      #{list items:analyzes, as:'analyzes'}
      <tr>
        <td>${analyzes.countryCode}</td>
        <td>${analyzes.centerId}</td>
        <td>${analyzes.totalWeight}</td>
        <td>${analyzes.totalVolume}</td>
        <td>${analyzes.seaWeight}</td>
        <td>${analyzes.seaVolume}</td>
        <td>${analyzes.airWeight}</td>
        <td>${analyzes.airVolume}</td>
        <td>${analyzes.expressWeight}</td>
        <td>${analyzes.expressVolume}</td>
        <td>${analyzes.totalCost}</td>
        <td>${analyzes.seaCost}</td>
        <td>${analyzes.airCost}</td>
        <td>${analyzes.expressCost}</td>
      </tr>
      #{/list}
      </tbody>
    </table>
  </div>
</div>
