#{extends 'main_full.html' /}
#{set title:'运输丢失率统计报表'/}
#{set 'moreScripts'}
    #{script 'jquery.dataTables.js'/}
    #{script 'ShipmentReports/lossRate.coffee'/}
#{/set}

#{info_row}
<ul>
  <li><strong>运输丢失率统计报表</strong></li>
</ul>
#{/info_row}
#{flash_alert /}

<form action="@{ShipmentReports.lossRateReport()}" method="get" class="search_form" id='search_form'>
  <div class="row-fluid">
    <div class="span12">
      <div class="input-prepend inline">
        <span class="add-on">From:</span>
        <input type="date" name="p.from" value="${p.from.date()}">
      </div>

      <div class="input-prepend inline">
        <span class="add-on">To:</span>
        <input type="date" name="p.to" value="${p.to.date()}">
      </div>

      <select name="p.compenType" class="inline" style="width:110px;">
        <option value="" selected="selected">赔偿类型</option>
        <option value="amazon">Amazon</option>
        <option value="other">Other</option>
      </select>

      <div class="input-append input-prepend inline">
        <button class="btn btn-primary" data-loading>统计</button>
        <button class="btn btn-primary" id="exceldown">导出Excel</button>
      </div>
    </div>
  </div>
</form>


<div class="row-fluid">
  <div class="span12">
    <table id="losstotal" class="table table-condensed table-bordered">
      <thead>
      <tr>
        <th>总丢失量</th>
        <th>总运输量</th>
        <th>丢失率%</th>
        <th>总赔偿金额(单位: USD)</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>
        ${losstotal.totalqty}
        </td>
        <td>
        ${losstotal.shipqty}
        </td>
        <td>
        ${losstotal.lossrate}
        </td>
        <td>
        ${losstotal.totalamt}
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>


<div class="row-fluid">
  <div class="span12">
    <table id="lossrate" class="table table-condensed table-bordered">
      <thead>
      <tr>
        <th>FBA</th>
        <th>SKU</th>
        <th>运输量</th>
        <th>丢失量</th>
        <th>赔偿金额(单位: USD)</th>
      </tr>
      </thead>
      <tbody>
      #{list items:lossrates, as:'loss'}
      <tr>
        <td>
        ${loss.fba}
        </td>
        <td>
        ${loss.sku}
        </td>
        <td>
        ${loss.qty}
        </td>
        <td>
        ${loss.lossqty}
        </td>
        <td>
        ${loss.compenusdamt}
        </td>
      </tr>
      #{/list}
      </tbody>
    </table>
  </div>
</div>
