#{extends 'main.html'/}

#{set title:"通知信息列表" /}
#{set 'moreScripts'}
    #{script 'component/pagination.coffee'/}
#{/set}

#{info_row title:"Notifications"/}

#{form @Notifications.index(), class:'search_form', id:'notifications_form'}
<div class="row-fluid">
  <div class="span12">
    <div class="input-prepend  inline">
      <a href="#" class="btn btn-primary" id="updateState" rel="popover" content="将选中的通知标记为已读" >
        已查阅
      </a>
    </div>

    <div class="input-prepend  inline">
      <span class="add-on">From:</span>
      <input type="date" name="p.from" value="${p.from.date()}">
    </div>
    <div class="input-prepend inline">
      <span class="add-on">To:</span>
      <input type="date" name="p.to" value="${p.to.date()}">
    </div>

    <div class="inline">
        #{select_enum name:'p.dateType', items:models.view.post.NotificationPost.DateType.values(), value:p.dateType /}

        #{select_enum name:'p.state', items:models.Notification.S.values(), value:p.state}
          <option value="">状态</option>
        #{/select_enum}

    </div>

    <div class="input-prepend input-append inline">
      <span class="add-on"><i class="icon-search"></i></span>
      <input type="hidden" name="p.page" value="${p.page}">
      <input type="text" name="p.search" class="input-medium" value="${p.search}" placeHolder="搜索 标题 ">
      <button class="btn btn-primary" data-loading>搜索</button>
    </div>
  </div>
</div>


#{if notifications.size() == 0}
<div class="row-fluid" id="order_list">
  <div class="span12">
    暂时还没有通知
  </div>
</div>
#{/if}
#{else }
<div class="row">
   <div class="span12">
      <table class="table table-bordered table-condensed">
        <tr>
           <th><label><input type="checkbox" class="checkall"></label></th>
           <th>#</th>
           <th>标题</th>
           <th>内容</th>
           <th>创建时间</th>
           <th>通知时间</th>
        </tr>
      #{list items:notifications, as:'note'}
        <tr>
           <td>
             <label>
               #{if note?.state == models.Notification.S.UNCHECKED}
                 <label><input type="checkbox" name="noteID" value="${note.id}"></label>
               #{/if}
             </label>
           </td>
           <td><a name="${note.createAt}">${note.id}</a></td>
           <td>${note.title}</td>
           <td>${note.content}</td>
           <td>#{time_tooltip time:note.createAt, datetime:true/}</td>
           <td>#{time_tooltip time:note.notifyAt, datetime:true/}</td>
        </tr>
       #{/list}
      </table>
   </div>
</div>
#{bootstrap_pager pi:p, url:'' /}
#{/else}
#{/form}


