#{extends 'main_full.html' /}
#{set title:"支付单信息"  /}
#{set 'moreStyles'}
    #{stylesheet 'payments.css'/}
#{/set}
#{set 'moreScripts'}
    #{script 'payments.coffee'/}
    #{script 'jquery.filedrop.js'/}
    #{script 'component/dropUpload.coffee'/}
#{/set}
<div>
    <div class="row-fluid">
        <div class="input-prepend span2 offset1">
            <span class="add-on">#</span>
            <input id="paymentId" readonly="true" type="text" value="${payment.id}">
        </div>
        <div class="input-prepend span5">
            <span class="add-on">Title</span>
            <input type="text" class="input-xxlarge" placeholder="标题, TBD" value="">
        </div>
    </div>

    <div class="row-fluid">
    #{flash_alert /}
        <div class="btn-group">
            <button id="select_all" class="btn btn-small">全选</button>
            <button id="select_inverse" class="btn btn-small">反选</button>
        </div>
        <div class="btn-group">
            <button id="approval" data-url='@{Payments.approval(payment.id)}' class="btn btn-small btn-primary">
                批准
            </button>
            <button id="paid" data-url='@{Payments.paid(payment.id)}' class="btn btn-small btn-success">
                已付款
            </button>
            <button id="deny" data-url='@{Payments.deny(payment.id)}' class="btn btn-small btn-danger">
                驳回
            </button>
        </div>
    #{form @Payments.show(payment.id), id:'unit_list', method:'post'}
        <table class="table table-bordered table-condensed table-checkboxk">
            <tr>
                <th class="three"></th>
                <th>#</th>
                <th>外键</th>
                <th>总金额</th>
                <th>费用类型</th>
                <th>状态</th>
            </tr>
            #{list items:payment.units,as:'fee'}
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" name="unitIds" value="${fee.id}">
                        </label>
                    </td>
                    <td>${fee.id}</td>
                    <td>#{render './_foreignKey.html', fee:fee /}</td>
                    <td>${fee.currency.symbol()} ${fee.amount}</td>
                    <td>${fee.feeType.nickName}</td>
                    <td>${fee.state}</td>
                </tr>
            #{/list}
        </table>
    #{/form}
    </div>

    <div class="row-fluid">
        <div id="exchange">
            <div id="exchange_rate" class="span6"></div>
            <div class="span6">
                <p>
                    <a href="http://www.boc.cn/sourcedb/whpj/" target="_blank">
                        中国银行外汇挂牌 <i class="icon-external-link"></i>
                    </a>
                </p>

                <p class="muted">
                    <button class="btn btn-mini" id="refreshRate">
                        <i class="icon-refresh"></i>
                    </button>
                    <i class="icon-info-sign" style=""></i> 仅供参考
                </p>
            </div>
        </div>
        <table class="table table-bordered table-condensed">
            <tr>
                <th rowspan="3">实际支付</th>
                <td rowspan="3" class="ten">#{pickCurrency /}</td>
                <td rowspan="3" class="ten">
                    <input type="text" value="${payment.actualPaid}">
                </td>
            </tr>
            <tr>
                <th>汇总 USD</th>
                <td>${helper.Currency.USD.symbol()} ${payment.totalFees()._1}</td>
            </tr>
            <tr>
                <th>汇总 CNY</th>
                <td>${helper.Currency.CNY.symbol()} ${payment.totalFees()._2}</td>
            </tr>
        </table>
    </div>

    <div class="row-fluid">
        <div style="min-height:300px;background:#eee;" id="dropbox">
            <ul class="thumbnails uploaded"></ul>
            <div class="message" style="height:150px;padding-top:145px;text-align:center;">
                Drag & Drop
            </div>
        </div>
    </div>
</div>
