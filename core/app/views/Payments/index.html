#{extends 'main_full.html' /}
#{set title:"付款单列表"  /}
#{set 'moreStyles'}
    #{stylesheet 'payments.css'/}
#{/set}
#{set 'moreScripts'}
#{/set}

#{info_row title: "请款项目"}
<ul>
  <li class="text-warning">分页与搜索后续补上</li>
</ul>
#{/info_row}
<div class="row-fluid">
  <table class="table table-bordered table-condensed">
    <tr>
      <th class="">请款单编号</th>
      <th class="ten">涉及的请款人</th>
      <th class="ten">支付人</th>
      <th>合作伙伴</th>
      <th class="ten">状态</th>
      <th class="ten">总请款金额</th>
      <th class="ten">总实际支付金额</th>
      <th>最近更新时间</th>
      <th>创建时间</th>
    </tr>
  #{list items:payments, as:'pay'}
    <tr>
      <td><a href="@{Payments.show(pay.id)}">${pay.paymentNumber}</a></td>
      <td>
          #{list items:pay.applyers(), as:'applyer'}
          ${applyer.username} &nbsp;
          #{/list}
      </td>
      <td>${pay.payer?.username}</td>
      <td>
          #{list items:pay.cooperators(), as:'cop'}
            ${cop.fullName}
          #{/list}
      </td>
      <td style="color:${pay.stateColor()}">${pay.state.label()}</td>
      <td>
        <a href="javascript:;"
           rel="tooltip"
           title="汇率:${helper.Currency.USD.ratio(helper.Currency.CNY)} CNY:${pay.totalFees()._2}">
        ${helper.Currency.USD.symbol()}${pay.totalFees()._1.format('#.##')}
        </a>
      </td>
      <td>
        <i class="badge badge-info">${pay.units().size()}</i>${pay.actualCurrency?.symbol()}${pay.actualPaid}
      </td>
      <td>#{time_tooltip time:pay.updateAt, datetime:true/}</td>
      <td>#{time_tooltip time:pay.createdAt, datetime:true/}</td>
    </tr>
  #{/list}
  </table>
</div>
