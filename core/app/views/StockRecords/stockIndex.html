#{extends 'main_full.html' /}
#{set title:"库存列表"  /}
#{set 'moreScripts'}
    #{script 'component/pagination.coffee'/}
    #{script 'outbounds/blank.js'/}
#{/set}
<style>
  .table td{
    vertical-align:middle;
  }
</style>
#{errorMsgs /}
#{flash_alert /}

<div class="row-fluid">
  <form action="@{StockRecords.stockIndex()}" method="get" class="search_form" id="search_Form">
    <div class="span12">
      <select name="p.whouse.id" class="inline " style="width:150px;">
        <option value="">仓库</option>
      #{list items:whouses, as:'w'}
        <option value="${w.id}" ${p.whouse?.id==w.id? 'selected' : ''}>${w.name}</option>
      #{/list}
      </select>

      <select name="p.projectName" class="inline">
        <option value="">项目名称</option>
        <option value="EASYACC" ${p.projectName=='EASYACC'?'selected':''}>EASYACC</option>
        <option value="B2B" ${p.projectName=='B2B'?'selected':''}>B2B</option>
      </select>

      <div class="input-prepend input-append inline">
        <span class="add-on"><i class="icon-search"></i></span>
        <input type="text" style="width:300px;" name="p.search" placeholder="sellingId or SKU" value="${p.search}">
        <input type="hidden" name="p.page" value="${p.page}">
        <button class="btn btn-primary" data-loading>搜索</button>
      </div>
    </div>
  </form>
</div>

<div class="row-fluid">
  <div class="span12">
    <table class="table table-condensed table-bordered">
      <tr>
        <th width="120px;">仓库</th>
        <th width="80px;">采购计划ID</th>
        <th width="350px;">Selling</th>
        <th width="200px;">SKU</th>
        <th>名称</th>
        <th width="60px;">入库数</th>
        <th width="60px;">可用库存</th>
        <th width="60px;">不良品数</th>
        <th width="120px;">FBA-ShipmentId</th>
        <th>项目名称</th>
        <th width="200px;">操作</th>
      </tr>
    #{list items: units, as: 'u'}
      <tr>
        <td>${u.currWhouse?.name}</td>
        <td>${u.id}</td>
        <td>${u.selling?.sellingId}</td>
        <td>${u.sku}</td>
        <td title="${u.product?.abbreviation}">${u.product?.abbreviation.overLong()}</td>
        <td>${u.inboundQty}</td>
        <td>${u.availableQty}</td>
        <td>${u.unqualifiedQty}</td>
        <td>${u.fba?.shipmentId}</td>
        <td>${u.projectName}</td>
        <td>
          <a href="@{StockRecords.changeRecords(u.id)}" class="btn btn-mini btn-info">
            <i class="icon-list-alt"></i>异动记录</a>
          <a href="@{StockRecords.adjustStock(u.id)}" class="btn btn-mini btn-warning">
            <i class="icon-share-alt"></i> 库存调整</a>
        </td>
      </tr>
    #{/list}
      <tr>
        <td colspan="11">
        #{if units.size() == 0}
          暂时还没有库存记录
        #{/if}
        #{else }
            #{bootstrap_pager pi:p, url:'' /}
        #{/else}
        </td>
      </tr>
    </table>
  </div>
</div>



