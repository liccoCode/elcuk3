<!-- 生成 Analyzes 页面下方的 selling 信息 -->
<table id="sorttable" class="table table-condensed table-bordered">
  <thead>
  <tr>
    <th title="可双击下面 MerchantSKU">SellingId</th>
    <th>Action</th>
    <th orderby='plan' name="plan">计划中 <i class="icon-sort"></i></th>
    <th orderby='working' name="working">制作中 <i class="icon-sort"></i></th>
    <th orderby='worked' name="worked">已交货 <i class="icon-sort"></i></th>
    <th orderby='way' name="way">在途 <i class="icon-sort"></i></th>
    <th orderby='inbound' name="inbound">入库 <i class="icon-sort"></i></th>
    <th orderby='reserved' name="reserved">Reserved <i class="icon-sort"></i></th>
    <th orderby='qty' name="qty">在库 <i class="icon-sort"></i></th>
    <th orderby='reviewRatio' name="reviewRatio">Reviews <i class="icon-sort"></i></th>
    <th orderby='rating' name="rating">Rating <i class="icon-sort"></i></th>
    <th orderby='ps' name="ps">PS <i class="icon-sort"></i></th>
    <th>_PS</th>
    <th orderby='day1' name="day1">Day1 <i class="icon-sort"></i></th>
    <th orderby='difference' name="difference">
      <abbr title="Day1与Day7平均值的差值(百分比)">Diff(%)</abbr>
    </th>
    <th orderby='day7' name="day7">Day7<i class="icon-sort"></i></th>
    <th >Day7ave</th>
    <th orderby='day30' name="day30">Day30<i class="icon-sort"></i></th>
    <th>Day30ave</th>
    <th>
      <abbr title="根据系统计算出的 ps 计算的这个产品现在(在库)的货物还能够周转多少天">
        TOR
      </abbr>
    </th>
    <th>
      <abbr title="根据人工设置的 ps 计算的这个产品现在(在库)的货物还能够周转多少天">
        TOR1
      </abbr>
    </th>
    <th>
      <abbr title="根据系统计算出的 ps 计算的这个产品现在(在库 + 在途 + 入库 + 在产)的货物还能够周转多少天;">
        _TOR
      </abbr>
    </th>
    <th>
      <abbr title="根据人工设置的 ps 计算的这个产品现在(在库 + 在途 + 入库 + 在产)的货物还能够周转多少天">
        _TOR1
      </abbr>
    </th>
    <th>
      <abbr title="多少天之后会断货(线条会接不上)">
        断货天数
      </abbr>
    </th>
    <th>
      实时价格
    </th>
    <th>
      生命周期
    </th>
    <th>
      主要运输方式
    </th>
    <th>退货率</th>
  </tr>
  </thead>
  <tbody>
  #{list items:dtos, as:'dto'}
  <tr>
    <td class="sid"><i class="icon-bolt"></i>
      <a href="@{Sellings.selling(dto.fid)}" target="_blank">${dto.fid}</a>
    </td>
    <td style="min-width: 105px;">
      <a href="${dto.asinLink()}" target="_blank"><i class="icon-link"></i> ${dto.asin}</a><br/>
      <a href="@{ProcureUnits.blank(dto.fid, dto.totalfive(), dto.day())}" target="_blank">
        <i class="icon-link"></i> 采购计划
      </a>
    </td>
    <td style="color:#A5B600" data-dtofid='<%= dto.fid %>'>${dto.plan}</td>
    <td class="text-warning">${dto.working}</td>
    <td style="color:#FE502A;">${dto.worked}</td>
    <td class="text-info">${dto.way}</td>
    <td style="color:#CC6615">${dto.inbound}</td>
    <td class="color:#CC6615">${dto.reserved}</td>
    <td class="text-success">${dto.qty}</td>
    <td>${dto.reviews}
      <small>${dto.reviewRatio.format('#')}</small>
    </td>
    <td>${dto.rating.format('#.##')}</td>
      #{set psDiffer:dto.getPsDiffer()/}
    <td style="text-align:center;width:90px;background:${'#'+psDiffer._2}">
      <div class="input-prepend" style="margin:0;">
        <span class="add-on" style="width:35px">${psDiffer._1.format('#%')}</span>
      </div>
    </td>
    <td style="text-align:center;width:90px;background:${'#'+psDiffer._2}">
      <div class="input-prepend" style="margin:0;">
        <input type="text" ps sid="${dto.fid}" value="${dto.ps}" style="width:45px;">
      </div>
    </td>
    <td>${dto.day1}</td>
    <td style="color:${dto.difference.rgb()}">
    ${dto.difference.format('#.##')}
      (${dto.percentage().format('#.##%')})
    </td>
    <td>${dto.day7}</td>
    <td>${(dto.day1 - dto.difference).format('#.#')}</td>
    <td>${dto.day30}</td>
    <td>${(dto.day30 / 30).format('#.#')}</td>
      #{turnOver turnOver:dto.sidTurnOverT4._1/}
      #{turnOver turnOver:dto.sidTurnOverT4._2/}
      #{turnOver turnOver:dto.sidTurnOverT4._3/}
      #{turnOver turnOver:dto.sidTurnOverT4._4/}
    <td style="background:${dto.step}">${dto.outday}</td>
    <td>${dto.displayPrice}</td>
    <td>
      <select name="sellingCycle" size="1" data-sellingid="${dto.fid}" style="width: 60px;">
        <option value="">无</option>
          #{list items:models.market.Selling.SC.values(), as: 'cycle'}
            <option value="${cycle}" ${cycle == dto.sellingCycle? 'selected':''}>${cycle.label()}</option>
          #{/list}
      </select>
    </td>
    <td>${dto.main_ship_type}</td>
    <td style="${dto.returnRates > 0.3 ? 'background-color:#FF0000' : ''}" rel="popover" data-content="${dto.returns}/${dto.sales}"
        placement="top">${dto.returnRates.format('#.#%')}
    </td>
  </tr>
  #{/list}
  <tr>
    <td colspan="20">
    #{bootstrap_pager pi:p, url:'#'/}
    </td>
  </tr>
  </tbody>
</table>