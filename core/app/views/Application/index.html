#{extends 'main_full.html' /}
#{set title:'Home' /}
#{set 'moreScripts'}
    #{script 'highcharts.js'/}
    #{script 'Application/app.coffee'/}
#{/set}

#{info_row title:('Ticket 处理情况总览 <small class="muted">' + now +'</small>').raw()/}
<div class="row-fluid">
    <div class="span12">
        <table class="table table-condensed table-bordered">
            <tr>
                <th>User</th>
                <th>今天回复的邮件数</th>
                <th>今天处理的 Ticket 数</th>
                <th>昨天回复的邮件数</th>
                <th>昨天处理的 Ticket 数</th>
                <th>还未处理的 Tickets</th>
                <th>总共处理的 Tickets</th>
            </tr>
        #{list items:ticketTable.keySet(), as:'user'}
            #{if user != "untake"}
                <tr>
                    #{set trow:ticketTable.get(user)/}
                    #{set yrow:yesterDayTicketTable.get(user)/}
                    <td>${user}</td>
                    <td>${trow.get('user_day_mails')}</td>
                    <td>${trow.get('user_day_tickets')}</td>
                    <td>${yrow.get('user_day_mails')}</td>
                    <td>${yrow.get('user_day_tickets')}</td>
                    <td>${trow.get('user_un_solved_tickets')}</td>
                    <td>${trow.get('user_solved_tickets')}</td>
                </tr>
            #{/if}
        #{/list}
            <tr>
                <td>总未完成的 Ticket</td>
                <td>${ticketMap.get("un_solved_tickets")}</td>
                <td>总完成的 Ticket</td>
                <td>${ticketMap.get("solved_tickets")}</td>
                <td colspan="3"></td>
            </tr>

        </table>
    </div>
</div>

#{info_row title:'FBA 仓库库存容量总览'/}
#{list items:fbaWhouse, as:'fba'}
<div class="row-fluid" style="margin-bottom:20px;">
${fba.capaticyContent.raw()}
</div>
#{/list}

#{info_row title:'订单总览'/}
<div class="row-fluid" id="orders">
    <div class="span12">
        <h2 class="label label-info" style="font-size:12px">订单信息&nbsp;<a href="#" id="cci" class="btn btn-mini">清理缓存</a>
        </h2>
        <table class="table table-bordered">
            <tr>
                <th>日期</th>
                <th>PENDING</th>
                <th>PAYMENT</th>
                <th>SHIPPED</th>
                <th>REFUNDED</th>
                <th>RETURNNEW</th>
                <th>CANCEL</th>
                <th><a href="#" rel="tooltip" data-original-title="是当天的成功的订单数量, 而不是销量">订单数</a></th>
            </tr>
        #{list items:odmaps.keySet(), as:'key'}
            #{set row:odmaps.get(key)/}
            <tr>
                <td date="${key}">${key}</td>
                #{list items:models.market.Orderr.S.values(), as:'s'}
                    <td><a href="#" rel="popover" placement='bottom' title="${s.name()} 细节" content="
                    DE: ${row.get(s.name() + "_" + "AMAZON_DE")}<br/>
                    US: ${row.get(s.name() + "_" + "AMAZON_US")}<br/>
                    UK: ${row.get(s.name() + "_" + "AMAZON_UK")}<br/>
                    FR: ${row.get(s.name() + "_" + "AMAZON_FR")}<br/><hr/>
                    EasyAcc.DE: ${row.get(s.name() + "_" + "amazon.de_wyatt")}<br/>
                    EasyAcc.US: ${row.get(s.name() + "_" + "amazon.com_wyatt")}<br/>
                    EasyAcc.EU: ${row.get(s.name() + "_" + "amazon.co.uk_wyatt")}<br/>
                    ">${row.get(s.name())}</a></td>
                #{/list}
                <td><a href="#" rel="popover" placement='left' title="订单数细节" content="
                    DE: ${row.get("all_" + "AMAZON_DE")}<br/>
                    US: ${row.get("all_" + "AMAZON_US")}<br/>
                    UK: ${row.get("all_" + "AMAZON_UK")}<br/>
                    FR: ${row.get("all_" + "AMAZON_FR")}<br/><hr/>
                    EasyAcc.DE: ${row.get("all_" + "amazon.de_wyatt")}<br/>
                    EasyAcc.US: ${row.get("all_" + "amazon.com_wyatt")}<br/>
                    EasyAcc.EU: ${row.get("all_" + "amazon.co.uk_wyatt")}<br/>
                ">${row.get('all')}</a></td>
            </tr>
        #{/list}
        </table>
    </div>
</div>

<div class="row-fluid">
    <div class="span3" style="height:400px;" id='cat_percent'></div>
    <div class="span3" style="height:400px;" id='cat_percent_de'></div>
    <div class="span3" style="height:400px;" id='cat_percent_us'></div>
    <div class="span3" style="height:400px;" id='cat_percent_uk'></div>
</div>

#{ck 'root'}
<div class="row-fluid">
    <div class="span3" style="height:400px;" id='sales_percent'></div>
    <div class="span3" style="height:400px;" id='sales_percent_de'></div>
    <div class="span3" style="height:400px;" id='sales_percent_us'></div>
    <div class="span3" style="height:400px;" id='sales_percent_uk'></div>
</div>
#{/ck}
