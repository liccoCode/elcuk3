#{extends 'main.html' /}
#{set title:'创建出库记录' /}
#{set 'moreScripts'}
    #{script 'outboundrecords/blank.coffee'/}
#{/set}
#{errorMsgs /}
#{flash_alert/}

#{form @OutboundRecords.create(), method:'POST', id: 'new_outbound_record'}
<h4 style="text-align:center" class="alert alert-info">添加其他出库</h4>
<table class="table table-condensed table-bordered">
  <tr>
    <th>物料编码</th>
    <td>
      <input type="text" name="record.stockObj.stockObjId" value="${record.stockObj?.stockObjId}" required>
      <input type="hidden" name="record.stockObj.stockObjType" value="${record.stockObj?.stockObjType}">
    </td>

    <th>产品名称</th>
    <td style="width: 40%;">
      <input type="text" name="stock_name" value="${record.stockObj?.name()}" class="input-xxlarge" required>
    </td>
  </tr>
  <tr>
    <th>仓库名称</th>
    <td>
      <select name="record.whouse.id">
          #{list items:whouses, as:'whouse'}
            <option ${whouse.id == record.whouse?.id ? 'selected' : ''} value="${whouse.id}">
            ${whouse.name}
            </option>
          #{/list}
      </select>
    </td>

    <th>出库类别</th>
    <td>
      <select name="record.type">
          #{list items: models.whouse.OutboundRecord.T.values(), as: 't'}
            <option value="${t.name()}" ${record.type == t ? 'selected' : ''}>${t.label()}</option>
          #{/list}
      </select>
    </td>
  </tr>
  <tr>
    <th>出库对象</th>
    <td>
      <select name="record.targetId" style="width: 230px;">
          #{list items:shippers, as: 'ship'}
            <option ${ship.id.toString() == record.targetId ? 'selected' : ''} value="${ship.id}">
            ${ship.name}
            </option>
          #{/list}
      </select>
    </td>

    <th>去往国家</th>
    <td>
      <select name="record.market" name="record.market" style="width: 230px;">
        <option value="">去往国家</option>
          #{list items:models.market.M.amazonVals(), as:'m'}
            <option ${m.name().equals(record.market) ? 'selected' : ''} value="${m.marketAndWhouseMapping()}">${m.marketAndWhouseMapping()}</option>
          #{/list}
      </select>
    </td>
  </tr>
  <tr>
    <th>FBA</th>
    <td>
      <input type="text" name="record.fba" value="${record.fba}">
    </td>

    <th>产品条码</th>
    <td>
      <input type="text" name="record.productCode" value="${record.productCode}">
    </td>
  </tr>
  <tr>
    <th>运输方式</th>
    <td>
      <select name="record.shipType" class="inline">
        <option value="">运输方式</option>
          #{list items:models.procure.Shipment.T, as:'t'}
            <option ${t == record.shipType ? 'selected' : ''} value="${t.name()}">${t.label()}</option>
          #{/list}
      </select>
    </td>

    <th>预计运输时间</th>
    <td>
      <input type="date" name="record.planBeginDate" value="${record.planBeginDate.date()}">
    </td>
  </tr>
  <tr>
    <th>预计出库数量</th>
    <td>
      <input type="text" name="record.planQty" value="${record.planQty}" class="input-mini" required>
    </td>

    <th>实际出库数量</th>
    <td>
      <input type="text" name="record.qty" value="${record.qty}" class="input-mini">
    </td>
  </tr>
  <tr>
    <th>备注</th>
    <td colspan="4">
      <textarea name="record.memo" rows="4" class="input-block-level">${record.memo}</textarea>
    </td>
  </tr>
  <tr>
    <td colspan="4">
      <input type="hidden" name="record.origin" value="${record.origin}">
      <input type="hidden" name="record.state" value="${record.state}">
      <input type="hidden" name="record.type" value="${record.type}">
      <input type="hidden" name="record.qty" value="${record.qty}">

      <button class="btn btn-primary" name="create_record">创建</button>
      <a href="@{OutboundRecords.index()}" class="btn btn-success">取消</a>
    </td>
  </tr>
</table>
#{/form}
