<tr>
  <td colspan="12">
  #{info_row}
    <li>基础信息</li>
  #{/info_row}
  </td>
</tr>
<tr>
  <th>质检任务 ID</th>
  <td>${check.id}</td>

  <th>产品编码</th>
  <td>
    <a href="@{Products.show(check.units?.product?.sku)}" target="_blank">
    ${check.units?.product?.sku}
    </a>
  </td>

  <th>产品名称</th>
  <td style="max-width: 80px;">
  ${check.units?.product?.abbreviation}
  </td>
</tr>
<tr>
  <th>收货计划 ID</th>
  <td>
    <a href="/ReceiveRecords/index?p.search=id:${check.receiveRecord?.id}" target="_blank">
    ${check.receiveRecord?.id}
    </a>
  </td>

  <th>物料计划 ID</th>
  <td>
    <a href="/ProcureUnits/index?p.search=id:${check.units?.id}" target="_blank">
    ${check.units?.id}
    </a>
  </td>
  <th>FBA</th>
  <td>${check.units?.fba?.shipmentId}</td>
</tr>
<tr>
  <th>FnSku</th>
  <td>${check.units?.selling?.fnSku}</td>

  <th>去往国家</th>
  <td>${check.units?.whouse?.name}</td>

  <th>预计运输时间</th>
  <td>#{time_tooltip time: check.receiveRecord?.confirmDate/}</td>
</tr>
<tr>
  <th>收货时间</th>
  <td>#{time_tooltip time: check.units.attrs.planShipDate, datetime: true/}</td>

  <th>收货数量</th>
  <td colspan="3">${check.receiveRecord?.qty}</td>
</tr>
<tr>
  <th>状态</th>
  <td>${check.checkstat.label()}</td>

  <th>质检方式</th>
  <td>
    <select name="check.qcType" style="width:80px;">
    #{list items:models.qc.CheckTask.T.values(), as: 'qcType'}
      <option value="${qcType.name()}" ${qcType == check.qcType? 'selected':''}>${qcType.label()}</option>
    #{/list}
    </select>
  </td>

  <th>质检员</th>
  <td>${check.matchChecktor()}</td>
</tr>
<tr>
  <th>实际抽检数量</th>
  <td>
    <input type="text" name="check.pickqty" class="input-mini" value="${check.pickqty}">
  </td>

  <th>质检取样</th>
  <td colspan="3">
    <input type="text" name="check.qcSample" class="input-mini" value="${check.qcSample}"
    ${check.result != null ? 'readonly' : ''} required/>
  </td>
</tr>
<tr>
  <th>是否合格</th>
  <td>
    <select name="check.result" style="width:80px;" ${check.result != null ? 'disabled' : ''}>
    #{list items:models.qc.CheckTask.ResultType.values(), as: 'result'}
      <option value="${result.name()}" ${result == check.result? 'selected':''}>${result.label()}</option>
    #{/list}
    </select>
  </td>

  <th>不合格数量</th>
  <td colspan="3">
    <input type="text" name="check.unqualifiedQty" class="input-mini" value="${check.unqualifiedQty}"
    ${check.result != null ? 'readonly' : ''} required>
  </td>
</tr>
<tr>
  <th>备注</th>
  <td colspan="5">
    <textarea name="check.checknote" rows="6" class="input-block-level">${check.checknote}</textarea>
    <input type="hidden" name="attid" value="${check.id}">
    <input type="hidden" name="id" value="${check.id}">
  </td>
</tr>
<tr>
  <td colspan="12">
  #{info_row}
    <li>AQL 质检</li>
  #{/info_row}
  </td>
</tr>

<tr>
  <th>抽检方式:</th>
  <td colspan="3">
  #{list items:['I', 'II', 'III'], as:'type'}
    <span class="span2">
      <input type="checkbox" name="check.samplingType" ${check.samplingType.contains(type) ? 'checked' : ''}
             value="${type}"> ${type}
    </span>
  #{/list}
  </td>

  <th>AC</th>
  <td colspan="8">
    <input type="text" name="check.ac" value="${check.ac}">
  </td>
</tr>

<tr>
  <th>送检次数:</th>
  <td colspan="3">
  #{list items:['1', '2', '3'], as:'num'}
    <span class="span2">
      <input type="checkbox" name="check.inspectionTime" ${check.inspectionTime.contains(num) ? 'checked' : ''}
             value="${num}"> ${num}
    </span>
  #{/list}
  </td>

  <th>RE</th>
  <td colspan="8">
    <input type="text" name="check.re" value="${check.re}">
  </td>
</tr>

<tr>
  <th>AQL:</th>
  <td colspan="11">
    <table class="table table-hover table-condensed table-bordered">
      <tr>
        <th>严重(Cr):</th>
        <td>
          <input type="text" name="check.cr" value="${check.cr}">
        </td>

        <th>主要(Ma):</th>
        <td>
          <input type="text" name="check.ma" value="${check.ma}">
        </td>

        <th>次要(Mi):</th>
        <td>
          <input type="text" name="check.mi" value="${check.mi}">
        </td>
      </tr>
    </table>
  </td>
</tr>
<tr>
  <td colspan="12">
    <table class="table table-hover table-condensed table-bordered" id="aqlTable">
      <tr>
        <th style="width:10%">序号</th>
        <th style="width:40%">不良描述</th>
        <th style="width:40%">检验结果</th>
        <th style="width:10%">Action</th>
      </tr>
    #{list items:check.aqlBadDesc, as:'desc'}
      <tr>
        <td>${desc_index}</td>
        <td>
          <input type="text" name="check.aqlBadDesc[${desc_index - 1}].badDesc" value="${desc.badDesc}">
        </td>
        <td>
            #{list items:['CR', 'MAJ', 'MIN'], as:'result'}
              <span class="span3">
                  <input type="checkbox" ${desc.inspectionResult.contains(result) ? 'checked' : ''}
                         name="check.aqlBadDesc[${desc_index - 1}].inspectionResult" value="${result}"> ${result}
                </span>
            #{/list}
        </td>
        <td>
          <a class="btn btn-danger" name="remove_desc_btn"><i class="icon-remove"></i> 删除</a>
        </td>
      </tr>
    #{/list}
    </table>
    <a class="btn" id="more_desc_btn" data-descsize=${check.aqlBadDesc.size()}><i class="icon-plus"></i>
      添加</a>
  </td>
</tr>
<tr>
  <td colspan="12">
  #{power.ck "checktasks.update"}
      #{ifnot check.isLock()}
        <input type="submit" id="fullupdate_btn" class="btn btn-warning" value="提交">
      #{/ifnot}
    <input type="submit" id="update_btn" class="btn btn-info" value="保存">
  #{/power.ck}
    <a href="@{CheckTasks.checklist()}" class="btn" data-loading>取消</a>
</tr>