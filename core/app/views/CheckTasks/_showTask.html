<tr>
  <td colspan="12">
  #{info_row}
    <li>基础信息</li>
  #{/info_row}
  </td>
</tr>
<tr>
  <th>采购计划ID</th>
  <td colspan="2">
  #{if controllers.Login.check("deliveryments.index")}
    <a href="@{Deliveryments.show(check.units?.deliveryment?.id)}" target="_blank">${check.units?.id}</a>
  #{/if}
  #{else}
  ${check.units?.id}
  #{/else}
  </td>
  <th>FBA</th>
  <td colspan="3">${check.units?.fba?.shipmentId}</td>
  <th>FnSku</th>
  <td colspan="4">${check.units?.selling?.fnSku}</td>
</tr>
<tr>
  <th>质检员</th>
  <td colspan="2">${check.matchChecktor()}</td>
  <th>状态</th>
  <td colspan="3">${check.checkstat.label()}</td>
  <th>订单数量</th>
  <td colspan="4">${check.units?.attrs?.planQty}</td>
</tr>
<tr>
  <th>实际交货数量</th>
  <td colspan="3">
    <input type="text" name="check.qty" class="input-mini" value="${check.qty}">
  </td>

  <th>实际交货日期</th>
  <td colspan="2">${check.units?.attrs.deliveryDate}</td>

  <th>处理方式</th>
  <td colspan="4">${check.dealway?.label()}</td>
</tr>
<tr>
  <th>实际抽检数量</th>
  <td colspan="3">
    <input type="text" name="check.pickqty" class="input-mini" value="${check.pickqty}">
  </td>

  <th>不合格数量</th>
  <td colspan="2">
    <input type="text" name="check.unqualifiedQty" class="input-mini" value="${check.unqualifiedQty}">
  </td>

  <th>质检方式</th>
  <td colspan="4">${check.qcType?.label()}</td>
</tr>
<tr>
  <th>质检开始时间</th>
  <td colspan="3">
    <input type="datetime" size="16" value="${check.startTime?.format("yyyy-MM-dd HH:mm")}" name="from" readonly>
  </td>
  <th>质检完成时间</th>
  <td colspan="7">
    <input type="datetime" size="16" value="${check.endTime?.format("yyyy-MM-dd HH:mm")}" name="to" readonly>
  </td>
</tr>
<tr>
  <th>质检取样</th>
  <td colspan="3"><input type="text" name="check.qcSample" value="${check.qcSample}"/></td>
  <th>采购取样</th>
  <td colspan="7"><input type="text" value="${check.units?.purchaseSample}" readonly/></td>
</tr>
<tr>
  <th>是否合格</th>
  <td colspan="3">
  #{select_enum name: 'check.result', items: models.qc.CheckTask.ResultType.values(), value: check.result/}
  </td>
  <th>是否发货</th>
  <td colspan="10">
    <select name="check.isship" size="1" disabled>
    #{list items:models.qc.CheckTask.ShipType.values(), as: 'shipType'}
      <option value="${shipType}" ${shipType == check.isship? 'selected':''}>${shipType.label()}</option>
    #{/list}
    </select>
  </td>
</tr>

#{if (check.dealway==models.qc.CheckTask.DealType.HELP && taskname!=null && taskname=="质检确认") || check.workhour>0 || check.workers>0}
<tr>
  <th>工作小时</th>
  <td>
    <input type="text" name="check.workhour" class="input-mini" value="${check.workhour}">
  </td>
  <th>人数</th>
  <td colspan="10">
    <input type="text" name="check.workers" class="input-mini" value="${check.workers}">
  </td>
</tr>
#{/if}

<tr>
  <th>备注</th>
  <td colspan="11">
    <textarea name="check.checknote" rows="5" cols="80" class="span12">${check.checknote}</textarea>
    <input type="hidden" name="attid" value="${check.id}">
    <input type="hidden" name="id" value="${check.id}">
  </td>
</tr>

<tr>
  <td colspan="12">
  #{info_row}
    <li>AQL 质检</li>
  #{/info_row}
  </td>
</tr>

<tr>
  <th>抽检方式:</th>
  <td colspan="3">
  #{list items:['I', 'II', 'III'], as:'type'}
    <span class="span2">
      <input type="checkbox" name="check.samplingType" ${check.samplingType.contains(type) ? 'checked' : ''}
             value="${type}"> ${type}
    </span>
  #{/list}
  </td>

  <th>AC</th>
  <td colspan="8">
    <input type="text" name="check.ac" value="${check.ac}">
  </td>
</tr>

<tr>
  <th>送检次数:</th>
  <td colspan="3">
  #{list items:['1', '2', '3'], as:'num'}
    <span class="span2">
      <input type="checkbox" name="check.inspectionTime" ${check.inspectionTime.contains(num) ? 'checked' : ''}
             value="${num}"> ${num}
    </span>
  #{/list}
  </td>

  <th>RE</th>
  <td colspan="8">
    <input type="text" name="check.re" value="${check.re}">
  </td>
</tr>

<tr>
  <th>AQL:</th>
  <td colspan="11">
    <table class="table table-hover table-condensed table-bordered">
      <tr>
        <th>严重(Cr):</th>
        <td>
          <input type="text" name="check.cr" value="${check.cr}">
        </td>

        <th>主要(Ma):</th>
        <td>
          <input type="text" name="check.ma" value="${check.ma}">
        </td>

        <th>次要(Mi):</th>
        <td>
          <input type="text" name="check.mi" value="${check.mi}">
        </td>
      </tr>
    </table>
  </td>
</tr>

<tr>
  <td colspan="12">
    <table class="table table-hover table-condensed table-bordered" id="aqlTable">
      <tr>
        <th style="width: 10%">序号</th>
        <th style="width: 40%">不良描述</th>
        <th style="width: 40%">检验结果</th>
        <th style="width: 10%">Action</th>
      </tr>
    #{list items:check.aqlBadDesc, as:'desc'}
      <tr>
        <td>${desc_index}</td>
        <td>
          <input type="text" name="check.aqlBadDesc[${desc_index - 1}].badDesc" value="${desc.badDesc}">
        </td>
        <td>
            #{list items:['CR', 'MAJ', 'MIN'], as:'result'}
              <span class="span3">
                  <input type="checkbox" ${desc.inspectionResult.contains(result) ? 'checked' : ''}
                         name="check.aqlBadDesc[${desc_index - 1}].inspectionResult" value="${result}"> ${result}
                </span>
            #{/list}
        </td>
        <td>
          <a class="btn btn-danger" name="remove_desc_btn"><i class="icon-remove"></i> 删除</a>
        </td>
      </tr>
    #{/list}
    </table>
    <a class="btn" id="more_desc_btn" data-descsize=${check.aqlBadDesc.size()}><i class="icon-plus"></i>
      添加</a>
  </td>
</tr>

<tr>
  <td colspan="12">
  #{info_row}
    <li>标准箱质检信息</li>
  #{/info_row}
    <table class="table table-hover table-condensed table-bordered" id="standTable">
    #{if check.standBoxQctInfos.size()==0}
      <tr>
        <th>箱数量：</th>
        <td colspan="2">
          <input type="text" class="input-mini" name="check.standBoxQctInfos[0].boxNum" value=""/>箱
          x
          <input type="text" class="input-mini" name="check.standBoxQctInfos[0].num" value=""/>个
        </td>
        <th>单箱体积(m³)：</th>
        <td colspan="3"><span></span></td>
      </tr>
      <tr>
        <th>单箱重量(kg)：</th>
        <td colspan="2">
          <input type="text" name="check.standBoxQctInfos[0].singleBoxWeight" value="">
        </td>
        <th>单箱长宽高(cm)：</th>
        <td colspan="3">
          <input type="text" class="input-mini" name="check.standBoxQctInfos[0].length" value="">
          x
          <input type="text" class="input-mini" name="check.standBoxQctInfos[0].width" value="">
          x
          <input type="text" class="input-mini" name="check.standBoxQctInfos[0].height" value="">
        </td>
      </tr>
    #{/if}
    #{list items:check.standBoxQctInfos, as:'stand'}
      <tr>
        <th>箱数量：</th>
        <td colspan="2">
          <input type="text" class="input-mini" name="check.standBoxQctInfos[${stand_index - 1}].boxNum" value="${stand
          .boxNum}"/>箱
          x
          <input type="text" class="input-mini" name="check.standBoxQctInfos[${stand_index - 1}].num" value="${stand
          .num}"/>个
        </td>
        <th>单箱体积(m³)：</th>
        <td colspan="3">${(stand.length*stand.width*stand.height/1000000).format('#.##')}</td>
      </tr>
      <tr>
        <th>单箱重量(kg)：</th>
        <td colspan="2">
          <input type="text" name="check.standBoxQctInfos[${stand_index - 1}].singleBoxWeight" value="${stand
          .singleBoxWeight}">
        </td>
        <th>单箱长宽高(cm)：</th>
        <td colspan="3">
          <input type="text" class="input-mini" name="check.standBoxQctInfos[${stand_index - 1}].length" value="${stand
          .length}">
          x
          <input type="text" class="input-mini" name="check.standBoxQctInfos[${stand_index - 1}].width" value="${stand
          .width}">
          x
          <input type="text" class="input-mini" name="check.standBoxQctInfos[${stand_index - 1}].height" value="${stand
          .height}">
        </td>
      </tr>
    #{/list}
    </table>
  </td>
</tr>

<tr>
  <td colspan="12">
  #{info_row}
    <li>尾箱质检信息</li>
  #{/info_row}
    <table class="table table-hover table-condensed table-bordered" id="tailBoxQctInfosTable">
    #{list items:check.tailBoxQctInfos, as:'tail'}
      <tr>
        <th>箱数量：</th>
        <td colspan="2">
          <input type="text" class="input-mini" name="check.tailBoxQctInfos[${tail_index - 1}].boxNum" value="${tail.boxNum}"/>箱
          x
          <input type="text" class="input-mini" name="check.tailBoxQctInfos[${tail_index - 1}].num" value="${tail.num}"/>个
        </td>
        <th>单箱体积(m³)：</th>
        <td colspan="4">${(tail.length*tail.width*tail.height/1000000).format('#.##')}</td>
      </tr>
      <tr>
        <th>单箱重量(kg)：</th>
        <td colspan="2">
          <input type="text" name="check.tailBoxQctInfos[${tail_index - 1}].singleBoxWeight" value="${tail.singleBoxWeight}">
        </td>
        <th>单箱长宽高(cm)：</th>
        <td colspan="3">
          <input type="text" class="input-mini" name="check.tailBoxQctInfos[${tail_index - 1}].length" value="${tail.length}">
          x
          <input type="text" class="input-mini" name="check.tailBoxQctInfos[${tail_index - 1}].width" value="${tail.width}">
          x
          <input type="text" class="input-mini" name="check.tailBoxQctInfos[${tail_index - 1}].height" value="${tail.height}">
        </td>
        <td>
          <a class="btn" name='delete_tailBoxQctInfos_row'>删除</a>
        </td>
      </tr>
    #{/list}

    </table>
    <table>
      <tr id="addBtnTr">
        <td align="right" colspan="6">
          <a class="btn" rel="popover" content="不够?那就再来一行" placement="right" id="addMultiBox" data-name="tailBoxQctInfos"
             data-table="tailBoxQctInfosTable" data-tr="addBtnTr" data-listSize="${check.tailBoxQctInfos.size()}">增加多尾箱输入
          </a>
        </td>
      </tr>
    </table>
  </td>
</tr>

<tr>
  <td colspan="12">
  #{if ap==null || ap.id==null}
      #{power.ck "checktasks.update"}
          #{if check.checkstat == models.qc.CheckTask.StatType.UNCHECK || check.checkstat == models.qc.CheckTask
          .StatType.REPEATCHECK}
            <a id="update_btn" href="javascript:void(0)" class="btn btn-info" data-loading>保存不提交</a>
            <a id="fullupdate_btn" href="javascript:void(0)" class="btn btn-primary" data-loading>保存并提交</a>
          #{/if}
      #{/power.ck}
    <a href="@{CheckTasks.checkerList()}" class="btn btn-success" data-loading>取消</a>
  #{/if}
</tr>