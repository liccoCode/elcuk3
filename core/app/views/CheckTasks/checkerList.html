#{extends 'main_full.html'/}
#{set title:"质检员任务列表" /}
#{set 'moreScripts'}
    #{script name: 'jquery.dataTables.js'/}
    #{script name: 'checktasks/checkerlist.coffee'/}
#{/set}

#{flash_alert /}
#{errorMsgs /}

#{info_row}
<ul>
  <li><strong>质检任务列表</strong></li>
</ul>
#{/info_row}

#{form @CheckTasks.checkerList(), class:'search_form'}
<div class="row-fluid">
  <div class="span12">

    <div class="input-prepend inline">
      <select name="p.dateType" style="width:130px;">
          #{list items:models.view.post.CheckTaskPost.DATE_TYPES, as:'t'}
            <option ${t._1 == p.dateType ? 'selected' : ''} value="${t._1}">${t._2}</option>
          #{/list}
      </select>
    </div>
    <div class="input-append input-prepend inline">
      <span class="add-on">From:</span>
      <input type="date" style="width:90px;" name="p.from" value="${p.from.date()}">
      <span class="add-on" style="margin-left:20px;">To:</span>
      <input type="date" style="width:90px;" name="p.to" value="${p.to.date()}">
    </div>

    <div class="input-append input-prepend inline">
      <a class="btn btn_small" href="@{CheckTasks.checkerList(p,3)}">3天内</a>
      <a class="btn btn_small" href="@{CheckTasks.checkerList(p,2)}">2天内</a>
      <a class="btn btn_small" href="@{CheckTasks.checkerList(p,1)}">1天内</a>
    </div>

    <select style="margin-left:20px;" name="p.shipwhouseId" class="inline">
      <option value="0">货代仓库</option>
        #{list items:shipwhouses, as:'wh'}
          <option ${wh.id == p.shipwhouseId ? 'selected' : ''} value="${wh.id}">${wh.name}</option>
        #{/list}
    </select>

    <select name="p.cooperatorId" class="inline">
      <option value="0">供应商</option>
        #{list items:cooperators, as:'cop'}
          <option ${cop.id == p.cooperatorId ? 'selected' : ''} value="${cop.id}">${cop.name}</option>
        #{/list}
    </select>


    <select name="p.checkstat" class="inline">
      <option value="">状态</option>
        #{list items:models.qc.CheckTask.StatType, as:'s'}
          <option value="${s}" ${s == p.checkstat? 'selected' : ''}>${s.label()}</option>
        #{/list}
    </select>
    <select name="p.result" class="inline">
      <option value="">是否合格</option>
        #{list items:models.qc.CheckTask.ResultType, as:'r'}
          <option value="${r}" ${r == p.result? 'selected' : ''}>${r.label()}</option>
        #{/list}
    </select>

    <select name="p.isship" class="inline">
      <option value="">是否发货</option>
        #{list items:models.qc.CheckTask.ShipType, as:'i'}
          <option value="${i}" ${i == p.isship? 'selected' : ''}>${i.label()}</option>
        #{/list}
    </select>

    <select name="p.dealway" class="inline">
      <option value="">处理方式</option>
        #{list items:models.qc.CheckTask.DealType, as:'d'}
          <option value="${d}" ${d == p.dealway? 'selected' : ''}>${d.label()}</option>
        #{/list}
    </select>

    <input type="hidden" name="p.checkor" value="${p.checkor}">

    <div style="margin-left:40px;" class="input-prepend input-append inline">
      <span class="add-on"><i class="icon-search"></i></span>
      <input type="text" class="input-medium" name="p.search" placeholder="ID、SKU" value="${p.search}">
      <button class="btn btn-primary" data-loading>搜索</button>
    </div>

  </div>
</div>
#{/form}

<div class="row-fluid">
  <ul class="nav nav-tabs">
    <li class="active" id="below_tab">
      <a href="#checkList" data-toggle='tab'>待检任务</a>
    </li>
    <li>
      <a href="#checkRepeatList" data-toggle='tab'>重检任务</a>
    </li>
    <li>
      <a href="#checkedList" data-toggle='tab'>已结束任务</a>
    </li>
  </ul>

  <div class="tab-content">
    <div class="tab-pane fade active in" id='checkList'>
    #{include 'CheckTasks/_check.html'/}
    </div>

    <div class="tab-pane fade" id='checkRepeatList'>
    #{include 'CheckTasks/_checkRepeat.html'/}
    </div>

    <div class="tab-pane fade" id='checkedList'>
    #{include 'CheckTasks/_checked.html'/}
    </div>
  </div>
</div>

#{records records:records/}

